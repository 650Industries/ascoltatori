{"name":"Ascoltatori","tagline":"The pub/sub library for node backed by Redis, AMQP (RabbitMQ), ZeroMQ, MQTT (Mosquitto) or just plain node!","body":"Ascoltatori&nbsp;&nbsp;&nbsp;[![Build Status](https://travis-ci.org/mcollina/ascoltatori.png)](https://travis-ci.org/mcollina/ascoltatori) [![Coverage Status](https://coveralls.io/repos/mcollina/ascoltatori/badge.png?branch=master)](https://coveralls.io/r/mcollina/ascoltatori?branch=master)\r\n========================================\r\n\r\n> TIP: Ascoltatori is an italian word which means listeners.\r\nAn Ascoltatore is therefore a single listener.\r\n\r\nAscoltatori is a simple publish/subscribe library supporting the following brokers/protocols:\r\n\r\n* [Redis](http://redis.io/), a key/value store created by [@antirez](https://github.com/antirez).\r\n* [MongoDB](http://www.mongodb.org/), a scalable, high-performance, document-oriented database.\r\n* [Mosquitto](http://mosquitto.org/) and all implementations of the [MQTT](http://mqtt.org/) protocol.\r\n* [RabbitMQ](http://www.rabbitmq.com/) and all implementations of the [AMQP](http://www.amqp.org/) protocol.\r\n* [ZeroMQ](http://www.zeromq.org/) to use Ascoltatori in a P2P fashion.\r\n\r\nFind out more about Ascoltatori reading the\r\n[dox generated documentation](http://mcollina.github.com/ascoltatori/docs/lib/ascoltatori.js.html)\r\n\r\n[![NPM](https://nodei.co/npm/ascoltatori.png)](https://nodei.co/npm/ascoltatori/)\r\n[![NPM](https://nodei.co/npm-dl/ascoltatori.png)](https://nodei.co/npm/ascoltatori/)\r\n\r\n## Install\r\n\r\nInstall the library using [npm](http://npmjs.org/).\r\n\r\n```\r\n$ npm install ascoltatori --save\r\n```\r\n\r\nInstall the library using git.\r\n\r\n```\r\n$ git clone git://github.com/mcollina/ascoltatori.git\r\n$ cd ascoltatori\r\n$ npm install\r\n```\r\n\r\n\r\n## Getting Started\r\n\r\nAscoltatori focuses on providing a simple and unique abstraction for all\r\nsupported brokes. Here a simple example using Redis.\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\n\r\nascoltatori.build(function (ascoltatore) {\r\n\r\n  // subscribes to a topic\r\n  ascoltatore.subscribe('hello', function() {\r\n    console.log(arguments);\r\n    // { '0': 'hello', '1': 'a message' }\r\n  });\r\n\r\n  // publishes a message to the topic 'hello'\r\n  ascoltatore.publish('hello', 'a message', function() {\r\n    console.log('message published');\r\n  });\r\n});\r\n```\r\n\r\n\r\n## Wildcards\r\n\r\nAll ascoltatori support the use of wildcards, so everything\r\nshould work smoothly on every broker.\r\nYou might find some differences, and in that case file a bug\r\nreport, so we can fix them.\r\n\r\nThe wildcard character `+` matches exactly one word:\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\n\r\nascoltatori.build(function (ascoltatore) {\r\n\r\n  ascoltatore.subscribe(\"hello/+/world\", function() {\r\n    // this will print { '0': \"hello/there/world\", '1': \"a message\" }\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.subscribe(\"hello/+\", function() {\r\n    // this will not be called\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.publish(\"hello/there/world\", \"a message\", function() {\r\n    console.log(\"message published\");\r\n  });\r\n});\r\n```\r\n\r\nThe wildcard character `*` matches zero or more words:\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\n\r\nascoltatori.build(function (ascoltatore) {\r\n\r\n  ascoltatore.subscribe(\"hello/*\", function() {\r\n    // this will print { '0': \"hello/there/world\", '1': \"a message\" }\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.subscribe(\"*\", function() {\r\n    // this will print { '0': \"hello/there/world\", '1': \"a message\" }\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.subscribe(\"hello/there/world/*\", function() {\r\n    // this will print { '0': \"hello/there/world\", '1': \"a message\" }\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.publish(\"hello/there/world\", \"a message\", function() {\r\n    console.log(\"message published\");\r\n  });\r\n});\r\n```\r\n\r\nOf course, you can mix `*` and `+` in the same subscription:\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\n\r\nascoltatori.build(function (ascoltatore) {\r\n\r\n  ascoltatore.subscribe(\"hello/+/world/*\", function() {\r\n    // this will print { '0': \"hello/foo/world/bar/42\", '1': \"a message\" }\r\n    console.log(arguments); \r\n  });\r\n\r\n  ascoltatore.publish(\"hello/foo/world/bar/42\", \"a message\", function() {\r\n    console.log(\"message published\");\r\n  });\r\n});\r\n```\r\n\r\n\r\n## Brokers\r\n\r\nAscoltatori supports different brokers. Here we show how to use each of them.\r\n\r\n### Redis\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar settings = {\r\n  type: 'redis',\r\n  redis: require('redis'),\r\n  db: 12,\r\n  port: 6379,\r\n  host: localhost\r\n};\r\n\r\nascoltatori.build(settings, function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\n### MongoDB\r\n\r\nMongoDB uses [Capped Collections](http://docs.mongodb.org/manual/core/capped-collections/)\r\nto implement the pub/sub pattern.\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar settings = {\r\n  type: 'mongo',\r\n  url: 'mongodb://127.0.0.1/ascoltatori',\r\n  pubsubCollection: 'ascoltatori',\r\n  mongo: {} // mongo specific options\r\n};\r\n\r\nascoltatori.build(settings, function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\nIt is also possible to reuse an existing mongodb connection:\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar MongoClient = require('mongodb').MongoClient;\r\n\r\nMongoClient.connect('mongodb://127.0.0.1/ascoltatori', {}, function (err, db) {\r\n  var settings = {\r\n    type: 'mongo',\r\n    db: db,\r\n    pubsubCollection: 'ascoltatori'\r\n  };\r\n  ascoltatori.build(settings, function (ascoltatore) {\r\n    // ...\r\n  });\r\n})\r\n```\r\n\r\n### MQTT (Mosquitto)\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nsettings = {\r\n  type: 'mqtt',\r\n  json: false,\r\n  mqtt: require('mqtt'),\r\n  host: '127.0.0.1',\r\n  port: 1883\r\n};\r\n\r\nascoltatori.build(settings, function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\n### AMQP (RabbitMQ)\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar settings = {\r\n  type: 'amqp',\r\n  json: false,\r\n  amqp: require('amqp'),\r\n  exchange: 'ascolatore5672'\r\n};\r\n\r\nascoltatori.build(settings, function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\n### ZeroMQ\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar settings = {\r\n  type: 'zmq',\r\n  json: false,\r\n  zmq: require(\"zmq\"),\r\n  port: \"tcp://127.0.0.1:33333\",\r\n  controlPort: \"tcp://127.0.0.1:33334\",\r\n  delay: 10\r\n};\r\n\r\nascoltatori.build(settings, function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\n### Memory\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nascoltatori.build(function (ascoltatore) {\r\n  // ...\r\n});\r\n```\r\n\r\n## JSON\r\n\r\nBy default, every ascoltatore built by the `ascoltatori.build` wraps every\r\npublished message in a JSON format. This behaviour can be triggered off by\r\npassing the `{ json: false }` option.\r\n\r\n```javascript\r\nrequire('ascoltatori').build({ json: false }, function(a) {\r\n  // ...\r\n});\r\n```\r\n\r\n## Domain support\r\n\r\nAscoltatori supports the [node.js domain API](http://nodejs.org/api/domain.html).\r\nUse it calling the `registerDomain` function on your Ascoltatore and it will take\r\ncare of routing the exceptions to the given domain. Look at this example:\r\n\r\n```javascript\r\nvar ascoltatori = require('ascoltatori');\r\nvar domain = require('domain');\r\n\r\nvar d = domain.create();\r\nd.on('error', function() {\r\n  console.log(arguments);\r\n});\r\n\r\nascoltatori.build(function (ascoltatore) {\r\n  ascoltatore.registerDomain(d);\r\n\r\n  ascoltatore.subscribe('hello/*', function() {\r\n    throw new Error();\r\n  });\r\n\r\n  ascoltatore.publish('hello/42', 'a message', function() {\r\n    console.log('message published');\r\n  });\r\n});\r\n```\r\n\r\n\r\n## Debugging\r\n\r\nAscoltatori supports the [debug](https://github.com/visionmedia/debug) package\r\nand triggers the logs based on an external enviroment variable.\r\n\r\n```\r\n$ DEBUG=ascoltatori:mqtt node exaples/mqtt_topic_bridge.js\r\n```\r\n\r\nThe following debug flags are supported:\r\n* `ascoltatori:amqp`\r\n* `ascoltatori:trie`\r\n* `ascoltatori:mqtt`\r\n* `ascoltatori:prefix`\r\n* `ascoltatori:redis`\r\n* `ascoltatori:zmq`\r\n* `ascoltatori:ee2`\r\n\r\n\r\n## Reliability\r\n\r\nDue to the various transports Ascoltatori uses, it is impossible to\r\ngarantee one of the various reliability properties across all of the\r\ntransports. However, the MQTT and AMQP ascoltatori provides at-least-once\r\nsemantics, which means that the message might be received more than once,\r\nbut at least once.\r\n\r\n\r\n## Feedback\r\n\r\nUse the [issue tracker](http://github.com/mcollina/ascoltatori/issues) for bugs.\r\n[Tweet](http://twitter.com/matteocollina) us for any idea that can improve the project.\r\n\r\n\r\n## Links\r\n\r\n* [GIT Repository](http://github.com/mcollina/ascoltatori)\r\n* [Ascoltatori Documentation](http://mcollina.github.com/ascoltatori/docs/ascoltatori.js.html)\r\n* [Redis](http://redis.io/)\r\n* [MongoDB](http://www.mongodb.org/)\r\n* [Mosquitto](http://mosquitto.org/)\r\n* [RabbitMQ](http://www.rabbitmq.com/)\r\n* [ZeroMQ](http://www.zeromq.org/)\r\n\r\n\r\n## Authors\r\n\r\n* [Matteo Collina](http://twitter.com/matteocollina)\r\n* [David Halls](https://github.com/davedoesdev)\r\n\r\n\r\n## Contributors\r\n\r\nSpecial thanks to the [following people](https://github.com/mcollina/ascoltatori/contributors) for submitting patches.\r\n\r\n\r\n## LICENSE - \"MIT License\"\r\n\r\nCopyright (c) 2012-2013 Matteo Collina and Contributors, http://matteocollina.com\r\n\r\nPermission is hereby granted, free of charge, to any person\r\nobtaining a copy of this software and associated documentation\r\nfiles (the \"Software\"), to deal in the Software without\r\nrestriction, including without limitation the rights to use,\r\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the\r\nSoftware is furnished to do so, subject to the following\r\nconditions:\r\n\r\nThe above copyright notice and this permission notice shall be\r\nincluded in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\r\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\r\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\r\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\r\nOTHER DEALINGS IN THE SOFTWARE.\r\n","google":"UA-20777444-4","note":"Don't delete this file! It's used internally to help with page regeneration."}